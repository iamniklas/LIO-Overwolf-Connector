<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="../../css/general.css" />
    <link rel="stylesheet" href="../../css/header.css" />
    <link rel="stylesheet" href="../../css/desktop.css" />
    <link rel="stylesheet" href="../../css/modal.css" />
    <title>LIO Connect Overwolf</title>
  </head>
  <body class="desktop">
    <!-- -------------------------------- Header ------------------------------- -->

    <header class="app-header">
      <img src="../../img/header_icon.svg" />
      <h1>LIO Connect Overwolf</h1>
      <div class="window-controls-group">
        <button class="icon window-control" id="minimizeButton">
          <svg>
            <use xlink:href="/img/header_icons.svg#window-control_minimize" />
          </svg>
        </button>
        <button
          class="icon window-control window-control-close"
          id="closeButton"
        >
          <svg>
            <use xlink:href="/img/header_icons.svg#window-control_close" />
          </svg>
        </button>
      </div>
    </header>

    <!-- --------------------------------- Main -------------------------------- -->
    <main>
      <div class="desktopBottom">
        <div id="left">
          <h1>
            Launch a supported game,and the In-Game window will pop-up automatically!
          </h1>
        </div>
        <div id="middle">
          Supported Games:
          <br>
          - CS:GO
          <br>
          - League of Legends
          <br>
          - Minecraft
          <br>
          - Fortnite
          <br>
          - Rainbow Six Siege
          <br>
          - Hearthstone
          <br>
          - Overwatch
          <br>
          - Path of Exile
          <br>
          - Rocket League
          <br>
          - Valheim
          <br>
          - Valorant
        </div>
        <!-- picture -->
        <div id="right">
          <div style="text-align: center">
            <div style="display: inline-block">
              <p id="gameinfo">The Game ID:</p>
              <button onclick="sendTestCall()">Test</button>
              <!--<img src="../../img/cool_wolf.png" />-->
            </div>
          </div>
        </div>
      </div>
    </main>

    <script src="../../lib/require.js"></script>
    <script>
      require(["desktop-controller"], function(DesktopController) {
        console.log(`[INIT] desktop module loaded`);
        const desktopCntroller = new DesktopController();
        desktopCntroller.run();
      }, function(error) {
        console.log(`[INIT] failed to load desktop module ${error}`);
      });

      window.onload = (event) => {
        fetch("http://000raspberry.ddns.net/lio/game?ip=192.168.178.60",
        {
          method: 'POST',
          body: "FadeToMultiColor:{\"mBundle\":{\"COLOR_PRIMARY\":{\"R\":100,\"G\":100,\"B\":100}, \"COLOR_SECONDARY\":{\"R\":100,\"G\":100,\"B\":100}, \"DURATION\": 0.75}}"
        })
        .then(response => {
          this.inGameView.logEvent("Done", true);
        });

        console.log('page is fully loaded');
      };

      function getGameInfo() {
        overwolf.games.getRunningGameInfo(function(){console.log(JSON.stringify(arguments))});
      }

      function sendTestCall() {
        fetch("http://000raspberry.ddns.net/lio/game?ip=192.168.178.60&event_type=teamGoal&color=255%20255%20255",
        {
          method: 'POST',
          body: "Rainbow:{\"mBundle\":{\"COLOR_SECONDARY\":{\"R\":0,\"G\":0,\"B\":0},\"COLOR_PRIMARY\":{\"R\":100,\"G\":0,\"B\":50}, \"DURATION\":40, \"REPETITIONS\": 0.75, \"SPEED\": 3.0, \"DIRECTION\": 3}}"
        })
        .then(response => {
          this.inGameView.logEvent("Done", true);
        });
      }
    </script>
  </body>
</html>
